<div class="dialogue-section" id="<%= id %>">
  <h4 class="dialogue-section-title valign"><%= title %>
    <% if (locals.helptext) { %>
      <span ui-tippy-hover="<%= locals.helptext %>" class="dispInlineBlock spacer5-left" style="height:18px;width:18px;"><%- icon('info',{width: 18, height:18}) %></span>
    <% } %>
    <% if (locals.wikitext && !locals.metatext) { %>
      <div class="grow"></div>
      <button class="secondary small" copy-target="wikitext-<%= id %>"
        ui-tippy-hover="Click to copy to clipboard"
        ui-tippy-flash="{content:'Copied!', delay: [0,2000]}"
        style="margin:5px 0 0">Copy</button>
    <% } %>
  </h4>
  <% if (locals.metatext) { %>
    <div class="valign">
      <p class="dialogue-section-meta">
        <% metatext.split('\n').map(x => x.trim()).filter(x => !!x).forEach(part => { %>
         <code class="item"><%= part %></code>
        <% }) %>
      </p>
      <% if (locals.wikitext) { %>
        <div class="grow"></div>
        <button class="secondary small" copy-target="wikitext-<%= id %>"
          ui-tippy-hover="Click to copy to clipboard"
          ui-tippy-flash="{content:'Copied!', delay: [0,2000]}"
          style="margin:0 0 5px">Copy</button>
      <% } %>
    </div>
  <% } %>
  <% if (locals.htmlMessage) { %>
    <div class="dialogue-section-info-message"><%- htmlMessage %></div>
  <% } %>
  <% if (locals.wikitext) { %>
    <textarea readonly id="wikitext-<%= id %>" class="dialogue-section-wikitext w100p" style="resize:vertical;min-height:40px;"><%= wikitext %></textarea>
  <% } %>
  <% if (locals.wikitextArray) { %>
    <% wikitextArray.forEach((item, idx) => { %>
      <textarea readonly id="wikitext-<%= id %>-<%= idx %>" class="dialogue-section-wikitext w100p" style="resize:vertical;min-height:40px;"><%= item %></textarea>
    <% }) %>
  <% } %>
  <div class="dialogue-section-children">
    <% children.forEach(section => { %>
     <%- include('partials/quests/dialogue-section', section) %>
    <% }) %>
  </div>
</div>